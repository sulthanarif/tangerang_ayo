<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/styles.css">
    <link rel="shortcut icon" href="assets/images/icon-tangerang-ayo.svg" type="image/x-icon">
    <title>Tangerang Ayo</title>
</head>
<body>
    <header>
        <nav class="container">
            <div class="halte">
                <h1 class="nama-halte">Halte Tanah Tinggi</h1>
                <p  class="keterangan-halte">Arah Poris</p>
            </div>
            <div class="logo">
                <img src="assets/images/logo-tangerang-ayo.svg" alt="Logo Tangerang Ayo" class="logo">
            </div>
        </nav>
        <div class="container">
            <div class="information-bar">
                <div class="marquee">
                    <div class="marquee__inner">
                      <p class="marquee__line">Pastikan Anda selalu memperhatikan barang bawaan Anda agar tidak tertinggal ketika naik atau turun dari bus. Perhatikan setiap langkah dengan hati-hati saat Anda keluar dari kendaraan. Selalu sediakan masker dan hand sanitizer saat bepergian. Utamakan jarak dan hindari kerumunan untuk keselamatan bersama. </p>
                    </div>
                  </div>
                <div class="date">
                    <p></p>
                </div>
                <div class="time">
                    <p></p>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="daftar-rute">
            <table>
                <thead>
                    <tr>
                        <th>Daftar Rute</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="wraped">
                                <div class="koridor">
                                    <img src="assets/images/koridor-1.svg" alt="Koridor 1" class="koridor">
                                </div>
                                <div class="info">
                                    <p class="tujuan">Poris Plawad - Jatake</p>
                                    <p class="operational">05:00 - 19:00</p>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="wraped">
                                <div class="koridor">
                                    <img src="assets/images/koridor-2.svg" alt="Koridor 2" class="koridor">
                                </div>
                                <div class="info">
                                    <p class="tujuan">Poris Plawad - Cibodas</p>
                                    <p class="operational">05:00 - 19:00</p>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section class="jadwal">
            <table>
                <thead>
                    <tr>
                        <th>Rute</th>
                        <th>Tujuan</th>
                        <th>Nomor Bus</th>
                        <th>Estimasi</th>
                    </tr>
                </thead>
                <tbody id="busSchedule">
                    <!-- datanya muncul -->
                </tbody>
            </table>
            <iframe src="./map.html" id="map"></iframe>
            
        </section>
    </main>
    
    

    <script type="module" src="assets/script/main.js"></script>
    <script>
        // Function untuk mengambil data kedatangan bus dari map.html
        const iframe = document.getElementById('map');
        const scheduleTable = document.getElementById('busSchedule');

        function updateBusSchedule() {
          const data = iframe.contentWindow.getBusScheduleData();
          scheduleTable.innerHTML = '';

          for (const bus of data) {
            const row = scheduleTable.insertRow();
            const routeCell = row.insertCell();
            const tujuanCell = row.insertCell();
            const busNumberCell = row.insertCell();
            const estimasiCell = row.insertCell();

            routeCell.textContent = bus.route;
            tujuanCell.textContent = bus.destination;
            busNumberCell.textContent = bus.busNumber;

            if (bus.estimatedArrivalTime) {
              estimasiCell.textContent = bus.estimatedArrivalTime;
            } else {
              estimasiCell.textContent = ''; // Estimasi hilang jika bus sudah lewat
            }
          }
        }

        window.addEventListener('message', (event) => {
          if (event.data.type === 'updateBusSchedule') {
            updateBusSchedule();
          }
        });

        // Panggil fungsi updateBusSchedule pertama kali
        updateBusSchedule();

      </script>
</body>
</html>